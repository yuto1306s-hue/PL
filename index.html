<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>募集一覧</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  h2 { margin-bottom: 20px; }
  .job-box { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
  .apply-btn { display: inline-block; padding: 8px 15px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px; }
  .status { font-weight: bold; margin-top: 10px; }
</style>
</head>
<body>

<h2>募集一覧</h2>
<div id="jobs-container"></div>

<script>
  // GASウェブアプリURLを2つ設定（現場Aと現場B）
  const urls = [
    'https://script.google.com/macros/s/AKfycbw_gmkDNPIbZcmwvMuHFrxgfHL7kcbIIXz3LmIAol23PoTovqeVYCR1OCF-wREzDa_NaA/exec',
    'https://script.google.com/macros/s/AKfycbz8FJp0ES3a4SpGzMhyFo5Agql2s0rvnXD7Q0mbk8hjhVjPS-57179ey3NXXlEq20n-/exec'
  ];

  const container = document.getElementById('jobs-container');

  urls.forEach(url => {
    fetch(url)
      .then(res => res.json())
      .then(data => {
        Object.keys(data).forEach(jobId => {
          const job = data[jobId];

          // 両現場とも募集人数1人に設定
          const maxApplicants = 1;
          const currentApplicants = job.currentApplicants;

          const div = document.createElement('div');
          div.className = 'job-box';

          div.innerHTML = `
            <p><strong>現場名：</strong>${job.name}</p>
            <p><strong>内容：</strong>${job.content}</p>
            <p><strong>勤務地：</strong>${job.location}</p>
            <p><strong>時間：</strong>${job.time}</p>
            <p class="status" id="${jobId}-status">${currentApplicants >= maxApplicants ? '募集終了' : '募集中'}</p>
            <a id="${jobId}-apply" class="apply-btn" href="${job.formUrl}" target="_blank" ${currentApplicants >= maxApplicants ? 'style="display:none;"' : ''}>応募する</a>
          `;

          container.appendChild(div);
        });
      })
      .catch(err => console.error('JSON取得エラー:', err));
  });
</script>

</body>
</html>
